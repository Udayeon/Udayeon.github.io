---
layout: post
title: 
description: |
  keras Model fit
hide_image: true
tags:
  - deeplearning
published: true
---

# (python) keras Model fitìœ¼ë¡œ í•™ìŠµí•˜ê¸°
* * *
# 1. Sequential model ë¶ˆëŸ¬ì˜¤ê¸°
```py
import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense,Flatten,Softmax, Conv2D, MaxPooling2D
from tensorflow.keras.preprocessing import image
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd

#Build a feedforward neural network model
model = Sequential([
    Flatten(input_shape=(28,28)),
    Dense(16,activation='relu',name='layer_1'),
    Dense(16,activation='relu'),
    Dense(10),
    Softmax()
])

model.summary()

#Build a Convolutional neural network model
model=Sequential([
    Conv2D(16, (3, 3), activation='relu', input_shape=(28, 28, 1)),
    MaxPooling2D((3, 3)),
    Flatten(),
    Dense(10, activation='softmax')
])
model.summary()

#Compile the model
opt =tf.keras.optimizers.Adam(learning_rate=0.005)
acc = tf.keras.metrics.SparseCategoricalAccuracy()
mae = tf.keras.metrics.MeanAbsoluteError()

model.compile(optimizer=opt,
              loss='sparse_categorical_crossentropy',
              metrics=[acc,mae])
```

ğŸ“Œ ì—¼ë‘í•  ê²ƒì€, classê°€ ì •ìˆ˜typeìœ¼ë¡œ ë¶„ë¥˜ë˜ë¯€ë¡œ lossí•¨ìˆ˜ë¡œ **Sparse_categorical_crossentropy**ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤.

# 2. model.fit
```py
# Print the resulting model attributes

# Load the data
fashion_mnist_data = tf.keras.datasets.fashion_mnist
(train_images, train_labels), (test_images, test_labels) = fashion_mnist_data.load_data()

# Print the shape of the training data
train_images.shape

# Define the labels
labels = [
    'T-shirt/top',
    'Trouser',
    'Pullover',
    'Dress',
    'Coat',
    'Sandal',
    'Shirt',
    'Sneaker',
    'Bag',
    'Ankle boot'
]

# Rescale the image values so that they lie in between 0 and 1.
train_images = train_images/255
test_images = test_images/255


# Display one of the images
i = 0
img = train_images[i,:,:]
plt.imshow(img)
plt.show()
print(f"label: {labels[train_labels[i]]}")

# Fit the model
model.fit(train_images[...,np.newaxis],train_labels, epochs=2, batch_size=256)
```
MNIST fashion datasetì„ ì‚¬ìš©.
   
í•™ìŠµê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.
![image](https://user-images.githubusercontent.com/69246778/142577184-0953767c-191c-47b3-aa63-ed104360ac4e.png)
   
epochsì„ 10ìœ¼ë¡œ ì˜¬ë ¤ì¤¬ë”ë‹ˆ ì •í™•ë„ê°€ ë†’ì•„ì§„ë‹¤.
![image](https://user-images.githubusercontent.com/69246778/142578755-e3c3881e-45c2-413b-a130-7b473da02d1a.png)

epochs=10ì— batch_size=196ìœ¼ë¡œ ì¤„ì˜€ë”ë‹ˆ ì •í™•ë„ê°€ ë†’ì•„ì§„ë‹¤
![image](https://user-images.githubusercontent.com/69246778/142579041-d4f30a4c-6220-4074-af6d-385282329526.png)

# 3. ê·¸ë˜í”„ë¡œ ë‚˜íƒ€ë‚´ê¸° plt.plot
```py
print(history.history.keys())
```
ë¥¼ ì´ìš©í•˜ë©´ historyì˜ keyê°€ ['loss','sparse_categorical_accuracy','mean_absolute_error']ë€ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŒ

```py
# Fit the model & Load the history into a pandas Dataframe
history=model.fit(train_images[...,np.newaxis],train_labels, epochs=8,batch_size=256, verbose=2)

plt.subplot(3,1,1)
plt.plot(history.history['loss'])
plt.title('loss')

plt.subplot(3,1,2)
plt.plot(history.history['sparse_categorical_accuracy'])
plt.title('sparse_categorical_accuracy')

plt.subplot(3,1,3)
plt.plot(history.history['mean_absolute_error'])
plt.title('mean_absolute_error')
plt.show()
```
   
ê²°ê³¼
![image](https://user-images.githubusercontent.com/69246778/142587469-8d9ae284-94fb-4871-94f4-d8c71feef7ff.png)
xì¶•ì€ epochsì„. epochsê°€ ì»¤ì§ˆìˆ˜ë¡ ì •í™•ë„ëŠ” ì¦ê°€í•˜ê³  errorëŠ” ê°ì†Œí•¨ì„ í™•ì¸.
ğŸ“Œì´ìœ  : epochsì€ datasetì„ ëª‡ ë²ˆ ë°˜ë³µí•™ìŠµ í• ì§€ë¥¼ ë‚˜íƒ€ë‚´ë¯€ë¡œ, ì—¬ëŸ¬ë²ˆ ë°˜ë³µ í•™ìŠµí• ìˆ˜ë¡ ë‹¹ì—°íˆ ì •í™•ë„ê°€ ë†’ì•„ì§. 
