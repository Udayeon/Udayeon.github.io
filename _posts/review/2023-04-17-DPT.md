---
layout: post
title: 
description: |
  Chen, Z., Zhu, Y., Zhao, C., Hu, G., Zeng, W., Wang, J., & Tang, M. (2021, October). Dpt: Deformable patch-based transformer for visual recognition. In Proceedings of the 29th ACM International Conference on Multimedia (pp. 2899-2907).
hide_image: true
tags:
  - review
published: true
---

# DPT: Deformable Patch-based Transformer for Visual Recognition
[Link](https://arxiv.org/abs/2107.14467)
* * *
**DPT ëª¨ë¸**ì€ ê³ ì • í¬ê¸°ì˜ íŒ¨ì¹˜ ëŒ€ì‹  **ë³€í˜• ê°€ëŠ¥í•œ íŒ¨ì¹˜**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ì—ì„œ íŠ¹ì§•ì„ ì¶”ì¶œí•œë‹¤. ë³€í˜• ê°€ëŠ¥í•œ íŒ¨ì¹˜ë¥¼ í†µí•´
ê°ì²´ì˜ ëª¨ì–‘ ë° í¬ê¸°ì— ì ì‘ì ìœ¼ë¡œ í•™ìŠµí•˜ë¯€ë¡œ ë†’ì€ ì„±ëŠ¥ì„ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤.

# 1. INTRODUCTION
Vision TrnasformerëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì…ë ¥ ì´ë¯¸ì§€ë¥¼ **'ê³ ì •ëœ í¬ê¸°'** ì˜ íŒ¨ì¹˜ë¡œ ë‚˜ëˆ„ê³  multi-head self-attentionì„ í†µí•´ 
íŒ¨ì¹˜ ê°„ì˜ ë¬¸ë§¥ì„ íŒŒì•…í•œë‹¤. CNNë³´ë‹¤ ì¥ê±°ë¦¬ ì˜ì¡´ì„±ì„ íš¨ê³¼ì ìœ¼ë¡œ í¬ì°©í•  ìˆ˜ ìˆê³  ì¶”ì¶œëœ featureì— ë” ë§ì€ ì˜ë¯¸ë¥¼ ë‹´ëŠ”ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.
ê·¸ëŸ¬ë‚˜ Transformerê°€ ì£¼ë¡œ í™œìš©í•˜ëŠ” **'ê³ ì •ëœ í¬ê¸°'** ì˜ íŒ¨ì¹˜ ë¶„í• ì€ ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤.   
a) ì„œë¡œ ë‹¤ë¥¸ ì´ë¯¸ì§€ì—ì„œ í¬ê¸°ê°€ ë‹¤ë¥¸ ê°ì²´ë“¤ë¡œ ìˆí•´ ì „ì²´ì ì¸ ê°ì²´ ê´€ë ¨ ì§€ì—­ êµ¬ì¡°ë¥¼ í¬ì°©í•˜ê¸° ì–´ë µë‹¤.   
b) ê°™ì€ ê°ì²´ë¼ë„ ì´ë¯¸ì§€ì— ë”°ë¼ ë‹¤ë¥¸ ìŠ¤ì¼€ì¼ê³¼ íšŒì „ì„ ê°–ëŠ”ë° ê³ ì •ëœ ë°©ì‹ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ë‚˜ëˆ„ë©´ ê°™ì€ ê°ì²´ì¸ë°ë„ ë‹¤ë¥´ê²Œ ì¸ì‹í•  ìˆ˜ ìˆë‹¤.   
![image](https://user-images.githubusercontent.com/69246778/237038936-99a4b878-281d-4f7a-a1fd-adfc1de32420.png)
ìœ„ì˜ ì‚¬ì§„ì„ ë³´ë©´, ë‘ ì‚¬ì§„ ëª¨ë‘ ë…ìˆ˜ë¦¬ì¸ë° íŒ¨ì¹˜ í¬ê¸°ê°€ ê³ ì •ë˜ì–´ ìˆë‹¤ë³´ë‹ˆ a)ë…ìˆ˜ë¦¬ ë°œí†±ì„ ì˜¨ì „íˆ í¬ì°©í•˜ì§€ ëª»í•˜ê³ , b)ë‘ ì‚¬ì§„ì˜ ë…ìˆ˜ë¦¬ë¥¼ 
ë§ˆì¹˜ ë‹¤ë¥¸ ê°ì²´ì¸ ê²ƒì²˜ëŸ¼ ì¸ì‹í•œë‹¤.   
ë³¸ ë…¼ë¬¸ì—ì„œëŠ” **DePatch**ë¼ëŠ” ìƒˆë¡œìš´ ëª¨ë“ˆì„ ì œì•ˆí•œë‹¤. ì´ ëª¨ë“ˆì„ PVTì— ë¶™ì—¬ì„œ ë³€í˜• ê°€ëŠ¥í•œ íŒ¨ì¹˜ë¡œ ì´ë¯¸ì§€ë¥¼ ë¶„í• í•˜ë©´ ê¸°ì¡´ì˜ ì„±ëŠ¥ë³´ë‹¤
2.3% ë†’ì€ ë¶„ë¥˜ ì •í™•ë„ë¥¼ ë‹¬ì„±í•  ìˆ˜ ìˆë‹¤.   
![image](https://user-images.githubusercontent.com/69246778/237039006-1905f92a-5c18-47b2-8d80-672e8e2ae917.png)
DePatchë¥¼ ì´ìš©í•˜ë©´ ìœ„ì˜ ì‚¬ì§„ì²˜ëŸ¼ ê°ì²´ë¥¼ ë”ìš± ì˜ í¬ì°©í•˜ê³  ê·¸ íŠ¹ì§•ì´ ë” ëª…í™•í•˜ê²Œ ë‹´ê¸´ë‹¤. 



# 2. RELATED WORK
## 2.1. Vision Transformer
* **Non-Local block and its variants**   
CNNì€ ê³µê°„ì ìœ¼ë¡œ ê°€ê¹Œìš´ ë¶€ë¶„ë§Œ ê³ ë ¤ë˜ê³  RNNì€ ì‹œê°„ì ìœ¼ë¡œ ê°€ê¹Œìš´ ë¶€ë¶„ë§Œ ê³ ë ¤ë˜ì–´ ì¥ê±°ë¦¬ì¸ ê²½ìš° ë¬¸ë§¥ì„ í¬ì°©í•˜ê¸° ì–´ë µë‹¤. 
ì´ë¥¼ í•´ì†Œí•˜ê¸° ìœ„í•´ ì§€ì—­ì— êµ¬ì•  ë°›ì§€ ì•ŠëŠ” Non-Local Networkê°€ ì œì•ˆë˜ì—ˆë‹¤. Gcnet,Ccnet,Non-local neural networks   
   
* **Only Vision Transformer**   
ViT
   
* **DeiT**   
ImageNetì—ì„œ í›ˆë ¨ëœ ëª¨ë¸ ì„±ëŠ¥ì„ í–¥ìƒ ì‹œí‚¤ê¸° ìœ„í•´ ë³µì¡í•œ í•™ìŠµ ìŠ¤ì¼€ì¤„ë§ê³¼ knowledge distillationì„ ì‚¬ìš©í•œë‹¤.   
   
* **CNN + transformer**   
Explicit Position Encodings for Vision Transformers, Bottleneck transformers   
   
* **ê³ í•´ìƒë„ í”¼ì²˜ë§µ ìœ ì§€**   
Transformer in transformer, Swin Transformer, Pyramid vision transformer   
   
* **ì§€ì—­ì„±ì— í¸í–¥ ëœ ë§¤ê°œ ë³€ìˆ˜ ì¶”ê°€**   
ConViT, detr with spatially modulated co-attention   
   
* **ë¬´ì°¨ë³„ì ìœ¼ë¡œ íŒ¨ì¹˜ ì„ë² ë”© ëª¨ë“ˆ ì„¤ê³„**   
Tokens-to-token vit   

## 2.2. Deformable-Related Work
ê³ ì •ëœ íŒ¨í„´ì„ ìˆ˜ì •í•´ì„œ ì ì‘ì ìœ¼ë¡œ ë§Œë“¤ë©´ ì„±ëŠ¥ ê°œì„ ì— íš¨ê³¼ì ì´ë‹¤. ë°©ë²• 2ê°€ì§€ê°€ ìˆë‹¤.   
* **Attention ê¸°ë°˜ ë°©ë²•**   
Gcnet, Squeeze-and-excitation networks, Ccnet, Non-local neural networks   
   
* **Offset ê¸°ë°˜ ë°©ë²•**   
Deformable convolutional network, Recurrent attention convolutional neural network, Glance and focus, Deformable convnets v2, Deformable DETR

# 3. METHOD
## 3.1 Preliminaries: Vision Transformer
íŒ¨ì¹˜ì„ë² ë”©ê³¼ multi-head self attentionì˜ ë°©ì •ì‹ í‘œí˜„   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/06343b97-d382-4efc-a870-061d0f5cef06)
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/c5b754d5-3f93-4b0b-84f1-f30860636a5a)
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/3867b034-73c5-4248-9316-543c2cb1c482)

## 3.2. DePatch Module
3.1ì˜ íŒ¨ì¹˜ ì„ë² ë”©ì€ íŒ¨ì¹˜ í¬ê¸°ê°€ ê³ ì •ì ì´ë¯€ë¡œ ê°ì²´ë¥¼ ë” ì˜ ì§€ì •í•˜ê³  ê¸°í•˜í•™ì  ë³€í˜•ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ì„  ë³€í˜• ê°€ëŠ¥í•œ íŒ¨ì¹˜ ì„ë² ë”©ì´ í•„ìš”í•˜ë‹¤.   
   
**1. ê° íŒ¨ì¹˜ì˜ ìœ„ì¹˜,í¬ê¸°ë¥¼ inputì— ê¸°ë°˜í•˜ì—¬ ì˜ˆì¸¡ëœ íŒŒë¼ë¯¸í„°ë¡œ ë³€í™˜**   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/9f7072e7-b756-41d4-b295-6d37ae2a3173)   
* 1-a. ìœ„ì¹˜ : ì›ë˜ ì¤‘ì‹¬ì  ì£¼ë³€ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆë„ë¡ ì˜¤í”„ì…‹(ğ›¿ğ‘¥, ğ›¿ğ‘¦) ì˜ˆì¸¡   
* 1-b. í¬ê¸° : ê³ ì •ëœ íŒ¨ì¹˜ í¬ê¸° së¥¼ ì˜ˆì¸¡ ê°€ëŠ¥í•œ shì™€ swë¡œ ëŒ€ì²´   
ê·¸ëŸ¼ ì•„ë˜ì™€ ê°™ì´ ìƒˆë¡œìš´ patchìœ„ì¹˜ê°€ ê²°ì •ëœë‹¤. ì´ë•Œ (ğ›¿ğ‘¥, ğ›¿ğ‘¦,sh, sw)ëŠ” íŒ¨ì¹˜ë§ˆë‹¤ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/7eaa0772-8152-42c4-b5b5-fd57fd63416a)   
   
**2. ì˜ˆì¸¡ëœ ì˜ì—­ê³¼ í•¨ê»˜ ì„ë² ë”©**   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/6193a70c-1095-433b-aed9-42ae3eb10939)   
* ëª¨ë“  íŒ¨ì¹˜ì— ëŒ€í•´ (ğ›¿ğ‘¥, ğ›¿ğ‘¦,sh, sw)ë¥¼ ë¹½ë¹½í•˜ê²Œ ì˜ˆì¸¡í•œ ë‹¤ìŒ, ê·¸ ì˜ì—­ìœ¼ë¡œ ì„ë² ë”©í•œë‹¤.   
* Figure2ë¥¼ ë³´ë©´, ì›ë˜ íŒ¨ì¹˜ì— offsetê³¼ scalesì„ ì ìš©í•´ì„œ ìƒˆë¡œìš´ íŒ¨ì¹˜ë¥¼ ë§Œë“¤ê³  ì´ê±¸ ì„ë² ë”©í–ˆë‹¤.   
   
**3. ìƒˆë¡œìš´ íŒ¨ì¹˜ ì˜ì—­ì´ ê²°ì •ëœ í›„ì— ê° íŒ¨ì¹˜ì— ëŒ€í•œ íŠ¹ì§•ì„ ì¶”ì¶œí•œë‹¤.**   
* ë¬¸ì œëŠ” ì˜ì—­ì˜ í¬ê¸°ê°€ ëª¨ë‘ ì œê°ê°ì´ê³  ì˜ˆì¸¡ëœ ì¢Œí‘œê°€ ì •ìˆ˜ë¡œ ì•ˆ ë–¨ì–´ì§„ë‹¤ëŠ” ê²ƒì´ë‹¤. (figure2-(b)ë³´ë©´ íŒ¨ì¹˜ í¬ê¸°ë„ ë‹¬ë¼ì§€ê³  ì¢Œí‘œë„ ì •ìˆ˜ë¡œ ì•ˆë–¨ì–´ì§)   
* ìœ„ì˜ ë¬¸ì œë¥¼ ìƒ˜í”Œë§ê³¼ ë³´ê°„ìœ¼ë¡œ í•´ê²°í•œë‹¤.   
* 3-a. ìƒ˜í”Œë§ : ìƒˆë¡œìš´ íŒ¨ì¹˜ ì˜ì—­ ë‚´ì— k x k ê°œì˜ ì ì„ ê· ì¼í•œ ê°„ê²©ìœ¼ë¡œ ìƒ˜í”Œë§í•˜ê³  ìƒ˜í”Œë§ ëœ ê° ì ì˜ í”¼ì²˜ë¥¼ flatten ë° ì„ë² ë”©í•œë‹¤.   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/3f1f3a10-47d8-46fb-b1b2-e0bf7e631c5e)   
ìƒ˜í”Œë§ëœ ì ì˜ ìœ„ì¹˜ í‘œí˜„ì€ ìœ„ì™€ ê°™ê³  ì´ ì ë“¤ì˜ íŠ¹ì§• aë¥¼ ì´ìš©í•˜ì—¬ ìƒˆë¡œìš´ íŒ¨ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ë©´ ì•„ë˜ ì‹ê³¼ ê°™ì´ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.   
   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/141f6f64-35e3-45e9-876b-a0cb7b8913e2)   
ië²ˆì§¸ íŒ¨ì¹˜ëŠ” ê·¸ íŒ¨ì¹˜ë¥¼ êµ¬ì„±í•˜ëŠ” k x kì˜ ê· ì¼ ê°„ê²© ì ë“¤ì˜ í”¼ì²˜ë¥¼ concatí•˜ê³  ê°€ì¤‘ì¹˜ë¥¼ ê³±í•œ ë‹¤ìŒ biasë¥¼ ë”í•œ ê²ƒìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìŒ.   
   
* 3-b. ë³´ê°„ë²• : 3-aì—ì„œ ìƒ˜í”Œë§í•œ ì ë“¤ì˜ ì¸ë±ìŠ¤(p_x , p_y)ëŠ” ë³´í†µ ì†Œìˆ˜ì ìœ¼ë¡œ í‘œí˜„ë˜ë¯€ë¡œ ì´ì°¨ ë³´ê°„ë²•ì„ ì‚¬ìš©í•œë‹¤.   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/6493d505-32dd-4173-807e-0625cb89f926)      
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/e6095842-ee03-48ce-99d5-2cbd18dc56d8)   
(qx,qy)ê°€ (px,py)ì— ê°€ê¹Œìš¸ìˆ˜ë¡ 1ì— ê°€ê¹ê³  ë©€ìˆ˜ë¡ 0ì— ê°€ê¹Œì›Œì§€ëŠ” Gë¥¼ ì´ìš©í•´ í•´ë‹¹ ìƒ˜í”Œë§ í¬ì¸íŠ¸ì˜ ìœ„ì¹˜ë¥¼ ì¶”ì •í•  ìˆ˜ ìˆë‹¤.   
   
## 3.3.  Overall Architecture
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/1224b890-1626-4cf0-ba3b-64002b5136c3)   
ì´ 4ê°œì˜ Stageë¡œ êµ¬ì„±ë˜ì–´ ìˆê³  PVTì˜ 2,3,4Stageì—ì„œ íŒ¨ì¹˜ ì„ë² ë”©ì„ DePatchë¡œ ëŒ€ì²´í•œë‹¤.   
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/a5e63cfb-035b-4519-a4d1-18edc73edf34)   
4 Stageì—ì„œ DePatchì ìš©ëœ ëª¨ìŠµì„ ì‹œê°í™” í•˜ë©´ ìœ„ì™€ ê°™ë‹¤. 

   
# 4. EXPERIMENTS
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/7540f3cc-160d-493e-948b-bf967d654e07)
![image](https://github.com/Udayeon/Udayeon.github.io/assets/69246778/7f4aa371-1ba0-4f78-aaa6-5d1aefc7f0d6)

