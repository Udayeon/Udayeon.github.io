---
layout: post
title: YOLOv2
description: |
  YOLOv2를 활용한 Multi object Detector
hide_image: true
tags:
  - ai
published: true
---


# Network training
* * *
trainig data의 라벨링이 끝났으면 이제 Network를 training해보자. **ResNet-50기반의 YOLOv2**를 이용한 Multi Object Detector를 구성할 계획이다.
[참고](https://kr.mathworks.com/help/vision/ug/create-yolo-v2-object-detection-network.html?searchHighlight=YOLO&s_tid=srchtitle)

# 1. Multi Object Detector 구성
매트랩 도움말에 나와있는 순서는 일단 다음과 같다.
![image](https://user-images.githubusercontent.com/69246778/130351314-b3cbe86b-d904-450e-9abd-0fa1e0a41ac4.png)

## 1.1. Load the pretrained network
미리 훈련된 네트워크를 먼저 load한다. (시간이 오래걸리니까 미리 되어있는거 걍 load하는 듯..?)   
ResNet-50기반의 YOLO를 사용할 거라서 **심층 신경망 디자이너 app -> ResNet-50설치**를 먼저 해준다
![image](https://user-images.githubusercontent.com/69246778/130351966-1f9f0a2b-e2d8-4c88-9482-6511d4a54959.png)
![image](https://user-images.githubusercontent.com/69246778/130352014-3b797bc0-6ce8-457d-9857-bf0e32ecfcbb.png)

```
>> net = mobilenetv2();
>> lgraph = layerGraph(net);
```

## 1.2. Update Network Input Size
내가 사용할 training data의 크기와 종류에 따라 input size를 결정해준다.

```
>> imageInputSize = [1242 375 3];
```
내가 사용할 KITTI data set은 **너비1242, 높이375, RGB** 데이터임.
   
```
>> imgLayer = imageInputLayer(imageInputSize,"Name","input_1")
```
그다음, 새로운 image의 input layer를 original layer랑 동일한 이름으로 만들어줌.

```
>> lgraph = replaceLayer(lgraph,"input_1",imgLayer);
```
레이어 그래프는 새로운 image input layer로 대체 된다.

## 1.3. Select Feature Extraction Layer
```
>> featureExtractionLayer = "block_12_add";
```

## 1.4. Remove Layers After Feature Extraction Layer

```
>> modified = load("mobilenetv2Block12Add.mat");
>> lgraph = modified.mobilenetv2Block12Add;
```

## 1.5. Create YOLO v2 Detection sub-Network
